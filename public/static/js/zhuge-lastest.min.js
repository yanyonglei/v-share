!function(){var a=Array.prototype,b=Object.prototype,c=a.slice,d=b.toString,e=b.hasOwnProperty,f=window.console,g=window.navigator,h=window.document,i=g.userAgent,j={},k="1.3.0",l="https://",m=(window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,!1),n={api_host:l+"apipool.zhugeio.com/web_event/?method=web_event_srv.upload",inherit_user_data:!0,debug:!1,ping:!1,ping_interval:12e3,idle_timeout:3e5,idle_threshold:1e4,track_link_timeout:300,cookie_expire_days:365,cookie_cross_subdomain:!0,cookie_secure:!1,info_upload_interval_days:7,session_interval_mins:30,app_channel:"web",app_version:"1.0"};!function(){var b=a.forEach,f=Array.isArray,g={};j.each=function(a,c,d){if(null!=a)if(b&&a.forEach===b)a.forEach(c,d);else if(a.length===+a.length){for(var f=0,h=a.length;h>f;f++)if(f in a&&c.call(d,a[f],f,a)===g)return}else for(var i in a)if(e.call(a,i)&&c.call(d,a[i],i,a)===g)return},j.extend=function(a){return j.each(c.call(arguments,1),function(b){for(var c in b)void 0!==b[c]&&(a[c]=b[c])}),a},j.isUndefined=function(a){return void 0===a},j.isString=function(a){return"[object String]"==d.call(a)},j.isArray=f||function(a){return"[object Array]"===d.call(a)},j.isFunction=function(a){try{return/^\s*\bfunction\b/.test(a)}catch(b){return!1}},j.isObject=function(a){return a===Object(a)&&!j.isArray(a)},j.includes=function(a,b){return-1!==a.indexOf(b)}}(),j.truncate=function(a,b){var c;return"string"==typeof a?c=a.slice(0,b):j.isArray(a)?(c=[],j.each(a,function(a){c.push(j.truncate(a,b))})):j.isObject(a)?(c={},j.each(a,function(a,d){c[d]=j.truncate(a,b)})):c=a,c},j.strip_empty_properties=function(a){var b={};return j.each(a,function(a,c){j.isString(a)&&a.length>0&&(b[c]=a)}),b},j.JSONEncode=function(){return function(a){var b=a,c=function(a){var b=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return b.lastIndex=0,b.test(a)?'"'+a.replace(b,function(a){var b=c[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'},f=function(a,b){var g="",h="    ",i=0,j="",k="",l=0,m=g,n=[],o=b[a];switch(o&&"object"==typeof o&&"function"==typeof o.toJSON&&(o=o.toJSON(a)),typeof o){case"string":return c(o);case"number":return isFinite(o)?String(o):"null";case"boolean":case"null":return String(o);case"object":if(!o)return"null";if(g+=h,n=[],"[object Array]"===d.apply(o)){for(l=o.length,i=0;l>i;i+=1)n[i]=f(i,o)||"null";return k=0===n.length?"[]":g?"[\n"+g+n.join(",\n"+g)+"\n"+m+"]":"["+n.join(",")+"]",g=m,k}for(j in o)e.call(o,j)&&(k=f(j,o),k&&n.push(c(j)+(g?": ":":")+k));return k=0===n.length?"{}":g?"{"+n.join(",")+m+"}":"{"+n.join(",")+"}",g=m,k}};return f("",{"":b})}}(),j.JSONDecode=function(){var a,b,c,d,e={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"	"},f=function(b){throw{name:"SyntaxError",message:b,at:a,text:c}},g=function(d){return d&&d!==b&&f("Expected '"+d+"' instead of '"+b+"'"),b=c.charAt(a),a+=1,b},h=function(){var a,c="";for("-"===b&&(c="-",g("-"));b>="0"&&"9">=b;)c+=b,g();if("."===b)for(c+=".";g()&&b>="0"&&"9">=b;)c+=b;if("e"===b||"E"===b)for(c+=b,g(),("-"===b||"+"===b)&&(c+=b,g());b>="0"&&"9">=b;)c+=b,g();return a=+c,isFinite(a)?a:void f("Bad number")},i=function(){var a,c,d,h="";if('"'===b)for(;g();){if('"'===b)return g(),h;if("\\"===b)if(g(),"u"===b){for(d=0,c=0;4>c&&(a=parseInt(g(),16),isFinite(a));c+=1)d=16*d+a;h+=String.fromCharCode(d)}else{if("string"!=typeof e[b])break;h+=e[b]}else h+=b}f("Bad string")},j=function(){for(;b&&" ">=b;)g()},k=function(){switch(b){case"t":return g("t"),g("r"),g("u"),g("e"),!0;case"f":return g("f"),g("a"),g("l"),g("s"),g("e"),!1;case"n":return g("n"),g("u"),g("l"),g("l"),null}f("Unexpected '"+b+"'")},l=function(){var a=[];if("["===b){if(g("["),j(),"]"===b)return g("]"),a;for(;b;){if(a.push(d()),j(),"]"===b)return g("]"),a;g(","),j()}}f("Bad array")},m=function(){var a,c={};if("{"===b){if(g("{"),j(),"}"===b)return g("}"),c;for(;b;){if(a=i(),j(),g(":"),Object.hasOwnProperty.call(c,a)&&f('Duplicate key "'+a+'"'),c[a]=d(),j(),"}"===b)return g("}"),c;g(","),j()}}f("Bad object")};return d=function(){switch(j(),b){case"{":return m();case"[":return l();case'"':return i();case"-":return h();default:return b>="0"&&"9">=b?h():k()}},function(e){var g;return c=e,a=0,b=" ",g=d(),j(),b&&f("Syntax error"),g}}(),j.HTTPBuildQuery=function(a,b){var c,d,e=[];return"undefined"==typeof b&&(b="&"),j.each(a,function(a,b){c=encodeURIComponent(a.toString()),d=encodeURIComponent(b),e[e.length]=d+"="+c}),e.join(b)},j.getQueryParam=function(a,b){b=b.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var c="[\\?&#]"+b+"=([^&#]*)",d=new RegExp(c),e=d.exec(a);if(null===e||e&&"string"!=typeof e[1]&&e[1].length)return"";var f=e[1];try{f=decodeURIComponent(decodeURIComponent(f)).replace(/\+/g," ")}catch(g){}return f},j.register_event=function(){function a(a,c,d){var e=function(e){if(e=e||b(window.event),!e)return void 0;var f,g,h=!0;return j.isFunction(d)&&(f=d(e)),g=c.call(a,e),(!1===f||!1===g)&&(h=!1),h};return e}function b(a){return a&&(a.preventDefault=b.preventDefault,a.stopPropagation=b.stopPropagation),a}var c=function(b,c,d,e){if(!b)return void o.error("No valid element provided to register_event");if(b.addEventListener&&!e)b.addEventListener(c,d,!1);else{var f="on"+c,g=b[f];b[f]=a(b,d,g)}};return b.preventDefault=function(){this.returnValue=!1},b.stopPropagation=function(){this.cancelBubble=!0},c}(),j.cookie={get:function(a){for(var b=a+"=",c=h.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "==e.charAt(0);)e=e.substring(1,e.length);if(0==e.indexOf(b))return decodeURIComponent(e.substring(b.length,e.length))}return null},parse:function(a){var b;try{b=j.JSONDecode(j.cookie.get(a))||{}}catch(c){}return b},set:function(a,b,c,d,e){var f="",g="",i="";if(d){var j=h.location.hostname.match(/[a-z0-9][a-z0-9\-]+\.[a-z\.]{2,6}$/i),k=j?j[0]:"";f=k?"; domain=."+k:""}if(c){var l=new Date;l.setTime(l.getTime()+24*c*60*60*1e3),g="; expires="+l.toGMTString()}e&&(i="; secure"),h.cookie=a+"="+encodeURIComponent(b)+g+"; path=/"+f+i},remove:function(a,b){j.cookie.set(a,"",-1,b)}},j.UUID=function(){var a=function(){for(var a=1*new Date,b=0;a==1*new Date;)b++;return a.toString(16)+b.toString(16)},b=function(){return Math.random().toString(16).replace(".","")},c=function(a){function b(a,b){var c,d=0;for(c=0;c<b.length;c++)d|=f[c]<<8*c;return a^d}var c,d,e=i,f=[],g=0;for(c=0;c<e.length;c++)d=e.charCodeAt(c),f.unshift(255&d),f.length>=4&&(g=b(g,f),f=[]);return f.length>0&&(g=b(g,f)),g.toString(16)};return function(){var d=(screen.height*screen.width).toString(16);return a()+"-"+b()+"-"+c()+"-"+d+"-"+a()}}(),j.info={campaignParams:function(){var a="utm_source utm_medium utm_campaign utm_content utm_term".split(" "),b="",c={};return j.each(a,function(a){b=j.getQueryParam(h.URL,a),b.length&&(c[a]=b)}),c},searchEngine:function(a){return 0===a.search("https?://(.*)google.([^/?]*)")?"google":0===a.search("https?://(.*)baidu.com")?"baidu":0===a.search("https?://(.*)sogou.com")?"sogou":0===a.search("https?://(.*)haosou.com")?"haosou":null},searchKeyword:function(a){var b=j.info.searchEngine(a);return"google"==b?j.getQueryParam(a,"q"):"baidu"==b?j.getQueryParam(a,"wd"):"sogou"==b?j.getQueryParam(a,"query"):"haosou"==b?j.getQueryParam(a,"q"):null},referringDomain:function(a){var b=a.split("/");return b.length>=3?b[2]:""},browser:function(a,b,c){var b=b||"";return c?j.includes(a,"Mini")?"Opera Mini":"Opera":/(BlackBerry|PlayBook|BB10)/i.test(a)?"BlackBerry":j.includes(a,"FBIOS")?"Facebook Mobile":j.includes(a,"Chrome")?"Chrome":j.includes(a,"CriOS")?"Chrome iOS":j.includes(b,"Apple")?j.includes(a,"Mobile")?"Mobile Safari":"Safari":j.includes(a,"Android")?"Android Mobile":j.includes(a,"Konqueror")?"Konqueror":j.includes(a,"Firefox")?"Firefox":j.includes(a,"MSIE")||j.includes(a,"Trident/")?"Internet Explorer":j.includes(a,"Gecko")?"Mozilla":""},os:function(){var a=i;return/Windows/i.test(a)?/Phone/.test(a)?"Windows Mobile":"Windows":/(iPhone|iPad|iPod)/.test(a)?"iOS":/Android/.test(a)?"Android":/(BlackBerry|PlayBook|BB10)/i.test(a)?"BlackBerry":/Mac/i.test(a)?"Mac OS X":/Linux/.test(a)?"Linux":""},device:function(a){return/iPad/.test(a)?"iPad":/iPod/.test(a)?"iPod Touch":/iPhone/.test(a)?"iPhone":/(BlackBerry|PlayBook|BB10)/i.test(a)?"BlackBerry":/Windows Phone/i.test(a)?"Windows Phone":/Android/.test(a)?"Android":""},resolution:function(){return screen.width+"*"+screen.height},properties:function(){var a=h.referrer,b=location.search.split("zhuge_referrer=")[1];return a=b?decodeURIComponent(b):a,j.strip_empty_properties({os:j.info.os(),br:j.info.browser(i,g.vendor,window.opera),dv:j.info.device(i),rs:j.info.resolution(),search:j.info.searchEngine(a),keyword:j.info.searchKeyword(a),url:h.URL,referrer:a,referrer_domain:j.info.referringDomain(a)})}};var o={log:function(){if(m&&!j.isUndefined(f)&&f)try{f.log.apply(f,arguments)}catch(a){j.each(arguments,function(a){f.log(a)})}},error:function(){try{if(m&&!j.isUndefined(f)&&f){var a=["Zhuge error:"].concat(j.toArray(arguments));try{f.error.apply(f,a)}catch(b){j.each(a,function(a){f.error(a)})}}}catch(c){}}},p=function(a,b){this.name=a,this.props={},this.config=j.extend({},b),this.load()};p.prototype.load=function(){var a=j.cookie.parse(this.name);a&&(this.props=j.extend({},a))},p.prototype.save=function(){j.cookie.set(this.name,j.JSONEncode(this.props),this.config.cookie_expire_days,this.config.cookie_cross_subdomain,this.config.cookie_secure)},p.prototype.register_once=function(a,b){return j.isObject(a)?("undefined"==typeof b&&(b="None"),j.each(a,function(a,c){this.props[c]&&this.props[c]!==b||(this.props[c]=a)},this),this.save(),!0):!1},p.prototype.register=function(a){return j.isObject(a)?(j.extend(this.props,a),this.save(),!0):!1};var q=function(){this.config={},j.extend(this.config,n),this.idle=0,this.last_activity=new Date};q.prototype._init=function(a,b){this._key=a,this._jsc=function(){},j.isObject(b)&&(j.extend(this.config,b),m=m||this.config.debug),this._initDid(),this.cookie=new p("zg_"+this._key,this.config);var c=j.cookie.get("_zg");c&&this.config.inherit_user_data?(c=j.JSONDecode(c),this.cookie.register_once(c,""),c.cuid&&this.cookie.register({cuid:c.cuid},""),j.cookie.remove("_zg")):this.cookie.register_once({sid:0,updated:0,info:0},""),this._session(),this._info(),this._startPing()},q.prototype._initDid=function(){var a=j.cookie.get("_zg"),b=j.UUID();a&&j.JSONDecode(a).uuid&&(b=j.JSONDecode(a).uuid),j.cookie.get("zg_did")||j.cookie.remove("zg_"+this._key),this.did=new p("zg_did",this.config),this.did.register_once({did:b},"")},q.prototype._session=function(){var a=this.cookie.props.updated,b=this.cookie.props.sid,c=1*new Date/1e3;if(0==b||c>a+60*this.config.session_interval_mins){if(b>0&&a>0){var d={};d.et="se",d.sid=b,d.dr=Math.round(1e3*(a-b))/1e3,this._batchTrack(d)}b=c;var e={};e.et="ss",e.sid=b,e.cn=this.config.app_channel,e.vn=this.config.app_version,e.pr=j.extend(j.info.properties(),j.info.campaignParams()),this._batchTrack(e),this.cookie.register({sid:b},"")}this.cookie.register({updated:c},"")},q.prototype._info=function(){var a=this.cookie.props.info,b=1*new Date;if(b>a+24*this.config.info_upload_interval_days*60*60*1e3){var c={};c.et="info",c.pr=j.extend(j.info.properties(),{cn:this.config.app_channel,vn:this.config.app_version}),this._batchTrack(c),this.cookie.register({info:b},"")}},q.prototype.debug=function(a){m=a},q.prototype.identify=function(a,b,c){this.cookie.register({cuid:a},""),this._session();var d={};d.et="idf",d.cuid=a,d.pr=b,d.sid=this.cookie.props.sid,this._batchTrack(d,c)},q.prototype.page=function(a,b){this._session();var c=h.location.href,d={};d.et="pg",d.pid=c,d.pn="undefined"==typeof a?c:a,d.tl=h.title,d.ref=h.referrer,d.sid=this.cookie.props.sid,this._batchTrack(d,b)},q.prototype.track=function(a,b,c,d){if(d){this._session();var e={};e.et="cus",e.eid=a,e.pr=b,e.ts=(d?d:new Date).getTime()/1e3,e.sid=this.cookie.props.sid,this._omitPatchTrack(e,d,c)}else{this._session();var e={};e.et="cus",e.eid=a,e.pr=b,e.ts=(new Date).getTime()/1e3,e.sid=this.cookie.props.sid,this._batchTrack(e,c)}},q.prototype.trackLink=function(a,b,c){if(!a)return this;j.isArray(a)||(a=[a]);var d=this;return j.each(a,function(a){var e=function(e){d.track(b,c),a.href&&"_blank"!==a.target&&!e.metaKey&&2!==e.which&&(e.preventDefault(),window.setTimeout(function(){window.location.href=a.href},this.config.track_link_timeout))};j.register_event(a,"click",e)}),this},q.prototype.trackForm=function(a,b,c){if(!a)return this;j.isArray(a)||(a=[a]);var d=this;return j.each(a,function(a){var e=function(e){e.preventDefault(),d.track(b,c),window.setTimeout(function(){a.submit()},TRACK_LINK_TIMEOUT)},f=window.jQuery||window.Zepto;f?f(a).submit(e):j.register_event(a,"submit",e)}),this},q.prototype._moved=function(a){this.last_activity=new Date,this.idle=0},q.prototype._startPing=function(){var a=this;j.register_event(window,"mousemove",function(){a._moved.apply(a,arguments)}),"undefined"==typeof this.pingInterval&&(this.pingInterval=window.setInterval(function(){a._ping()},this.config.ping_interval))},q.prototype._stopPing=function(){"undefined"!=typeof this.pingInterval&&(window.clearInterval(this.pingInterval),delete this.pingInterval)},q.prototype._ping=function(){if(this.config.ping&&this.idle<this.config.idle_timeout){var a={};a.type="ping",a.sdk="web",a.sdkv=k,a.ak=this._key,a.did=this.did.props.did,a.cuid=this.cookie.props.cuid,this._sendTrackRequest(a)}else this._stopPing();var b=new Date;return b-this.last_activity>this.config.idle_threshold&&(this.idle=b-this.last_activity),this},q.prototype.getDid=function(){return this.did.props.did},q.prototype._batchTrack=function(a,b){var c={};c.type="statis",c.sdk="web",c.sdkv=k,c.cn=this.config.app_channel,c.vn=this.config.app_version,c.ak=this._key,c.did=this.did.props.did,c.cuid=this.cookie.props.cuid,c.ts=1*new Date/1e3,j.cookie.get("responseTimeline")&&(c.lt=parseInt(j.cookie.get("responseTimeline"))),this.config.debug&&(c.debug=1);var d=[];d.push(a),c.data=d,this._sendTrackRequest(c,this._prepareCallback(b,c))},q.prototype._omitPatchTrack=function(a,b,c){var d={};d.type="statis",d.sdk="web",d.sdkv=k,d.cn=this.config.app_channel,d.vn=this.config.app_version,d.ak=this._key,d.did=this.did.props.did,d.cuid=this.cookie.props.cuid,d.ts=(b?b.getTime():(new Date).getTime())/1e3,j.cookie.get("responseTimeline")&&(d.lt=parseInt(j.cookie.get("responseTimeline"))),this.config.debug&&(d.debug=1);var e=[];e.push(a),d.data=e,this._sendTrackRequest(d,this._prepareCallback(c,d))},q.prototype._prepareCallback=function(a,b){if(!j.isFunction(a))return null;var c=function(c){a(c,b)};return c},q.prototype._sendTrackRequest=function(a,b){var c=j.truncate(a,255),d=j.JSONEncode(c);data={event:d,_:(new Date).getTime().toString()};var e=this.config.api_host+"&"+j.HTTPBuildQuery(data);this._sendRequest(e,b)},q.prototype._sendRequest=function(a,b){var c=(new Date).getTime(),d=new Image;d.src=a,d.onload=function(){j.cookie.set("responseTimeline",(new Date).getTime()-c),b&&b()},d.onerror=function(a){j.cookie.set("responseTimeline",(new Date).getTime()-c),b&&b()}},q.prototype.push=function(a){var b=a.shift();this[b]&&this[b].apply(this,a)},q.prototype.getKey=function(){return this._key};for(var r=window.zhuge||[],s=new q;r&&r.length>0;){var t=r.shift(),u=t.shift();s[u]&&s[u].apply(s,t)}window.zhuge=s}();